import{m as o,b as f,a as e,s,t as y}from"./DQCkQl5y.js";function v(m){let g=1;for(const u of m)u.type==="round"?u.level=g++:delete u.level;return m}function b(){let m=o(""),g=o("setup"),u=o(9),h=o(9),r=o(f([])),i=o(f([])),d=o(f([])),c=o(f([])),l=o(f({currentLevelIndex:0,timeRemaining:0,isRunning:!1,startTimestamp:0,timeRemainingAtStart:0}));return{get name(){return e(m)},set name(t){s(m,t,!0)},get status(){return e(g)},set status(t){s(g,t,!0)},get tableSize(){return e(u)},set tableSize(t){s(u,t,!0)},get finalTableThreshold(){return e(h)},set finalTableThreshold(t){s(h,t,!0)},get structure(){return e(r)},set structure(t){s(r,t,!0)},get players(){return e(i)},set players(t){s(i,t,!0)},get tables(){return e(d)},set tables(t){s(d,t,!0)},get eliminations(){return e(c)},set eliminations(t){s(c,t,!0)},get clock(){return e(l)},set clock(t){s(l,t,!0)},addPlayer(t){e(i).push({id:crypto.randomUUID(),name:t,status:"active",tableId:null,seat:null})},removePlayer(t){s(i,e(i).filter(a=>a.id!==t),!0)},get activePlayers(){return e(i).filter(t=>t.status==="active")},addRound({smallBlind:t,bigBlind:a,ante:n,duration:p}){e(r).push({type:"round",smallBlind:t,bigBlind:a,ante:n,duration:p,level:0}),v(e(r))},addBreak(t){e(r).push({type:"break",duration:t})},removeLevel(t){e(r).splice(t,1),v(e(r))},moveLevelUp(t){t<=0||((a=>{var n=y(a,2);e(r)[t-1]=n[0],e(r)[t]=n[1]})([e(r)[t],e(r)[t-1]]),v(e(r)))},moveLevelDown(t){t>=e(r).length-1||((a=>{var n=y(a,2);e(r)[t]=n[0],e(r)[t+1]=n[1]})([e(r)[t+1],e(r)[t]]),v(e(r)))},loadStructure(t){e(r).length=0,e(r).push(...structuredClone(t)),v(e(r))},eliminatePlayer(t,a){const n=e(i).find(p=>p.id===t);!n||n.status!=="active"||(n.status="eliminated",n.tableId=null,n.seat=null,e(c).push({playerId:t,eliminatedBy:a||null,round:e(l).currentLevelIndex,timestamp:new Date().toISOString()}))},save(){const t={name:e(m),status:e(g),tableSize:e(u),finalTableThreshold:e(h),structure:JSON.parse(JSON.stringify(e(r))),players:JSON.parse(JSON.stringify(e(i))),tables:JSON.parse(JSON.stringify(e(d))),eliminations:JSON.parse(JSON.stringify(e(c))),clock:{currentLevelIndex:e(l).currentLevelIndex,timeRemaining:e(l).timeRemaining,isRunning:!1,startTimestamp:e(l).startTimestamp,timeRemainingAtStart:e(l).timeRemainingAtStart}};localStorage.setItem("poker-tournament",JSON.stringify(t))},load(){const t=localStorage.getItem("poker-tournament");if(!t)return;const a=JSON.parse(t);s(m,a.name??"",!0),s(g,a.status??"setup",!0),s(u,a.tableSize??9,!0),s(h,a.finalTableThreshold??9,!0),e(r).length=0,e(r).push(...a.structure??[]),e(i).length=0,e(i).push(...a.players??[]),e(d).length=0,e(d).push(...a.tables??[]),e(c).length=0,e(c).push(...a.eliminations??[]),e(l).currentLevelIndex=a.clock?.currentLevelIndex??0,e(l).timeRemaining=a.clock?.timeRemaining??0,e(l).isRunning=!1,e(l).startTimestamp=a.clock?.startTimestamp??0,e(l).timeRemainingAtStart=a.clock?.timeRemainingAtStart??0},reset(){s(m,""),s(g,"setup"),s(u,9),s(h,9),e(r).length=0,e(i).length=0,e(d).length=0,e(c).length=0,e(l).currentLevelIndex=0,e(l).timeRemaining=0,e(l).isRunning=!1,e(l).startTimestamp=0,e(l).timeRemainingAtStart=0,localStorage.removeItem("poker-tournament")},get standings(){const t=e(i).filter(n=>n.status==="active").map(n=>({...n,position:null})),a=[...e(c)].reverse().map((n,p)=>({...e(i).find(S=>S.id===n.playerId),position:t.length+p+1}));return t.forEach((n,p)=>{n.position=p+1}),t.length===1&&(t[0].position=1),[...t,...a]}}}const I=b();export{I as t};
