import{f as o,g as h,i as e,j as l,t as y}from"./yuMo3aAj.js";function v(c){let g=1;for(const u of c)u.type==="round"?u.level=g++:delete u.level;return c}function b(){let c=o(""),g=o("setup"),u=o(9),f=o(9),r=o(h([])),s=o(h([])),d=o(h([])),m=o(h([])),i=o(h({currentLevelIndex:0,timeRemaining:0,isRunning:!1}));return{get name(){return e(c)},set name(t){l(c,t,!0)},get status(){return e(g)},set status(t){l(g,t,!0)},get tableSize(){return e(u)},set tableSize(t){l(u,t,!0)},get finalTableThreshold(){return e(f)},set finalTableThreshold(t){l(f,t,!0)},get structure(){return e(r)},set structure(t){l(r,t,!0)},get players(){return e(s)},set players(t){l(s,t,!0)},get tables(){return e(d)},set tables(t){l(d,t,!0)},get eliminations(){return e(m)},set eliminations(t){l(m,t,!0)},get clock(){return e(i)},set clock(t){l(i,t,!0)},addPlayer(t){e(s).push({id:crypto.randomUUID(),name:t,status:"active",tableId:null,seat:null})},removePlayer(t){l(s,e(s).filter(n=>n.id!==t),!0)},get activePlayers(){return e(s).filter(t=>t.status==="active")},addRound({smallBlind:t,bigBlind:n,ante:a,duration:p}){e(r).push({type:"round",smallBlind:t,bigBlind:n,ante:a,duration:p,level:0}),v(e(r))},addBreak(t){e(r).push({type:"break",duration:t})},removeLevel(t){e(r).splice(t,1),v(e(r))},moveLevelUp(t){t<=0||((n=>{var a=y(n,2);e(r)[t-1]=a[0],e(r)[t]=a[1]})([e(r)[t],e(r)[t-1]]),v(e(r)))},moveLevelDown(t){t>=e(r).length-1||((n=>{var a=y(n,2);e(r)[t]=a[0],e(r)[t+1]=a[1]})([e(r)[t+1],e(r)[t]]),v(e(r)))},loadStructure(t){e(r).length=0,e(r).push(...structuredClone(t)),v(e(r))},eliminatePlayer(t,n){const a=e(s).find(p=>p.id===t);!a||a.status!=="active"||(a.status="eliminated",a.tableId=null,a.seat=null,e(m).push({playerId:t,eliminatedBy:n||null,round:e(i).currentLevelIndex,timestamp:new Date().toISOString()}))},save(){const t={name:e(c),status:e(g),tableSize:e(u),finalTableThreshold:e(f),structure:JSON.parse(JSON.stringify(e(r))),players:JSON.parse(JSON.stringify(e(s))),tables:JSON.parse(JSON.stringify(e(d))),eliminations:JSON.parse(JSON.stringify(e(m))),clock:{currentLevelIndex:e(i).currentLevelIndex,timeRemaining:e(i).timeRemaining,isRunning:!1}};localStorage.setItem("poker-tournament",JSON.stringify(t))},load(){const t=localStorage.getItem("poker-tournament");if(!t)return;const n=JSON.parse(t);l(c,n.name??"",!0),l(g,n.status??"setup",!0),l(u,n.tableSize??9,!0),l(f,n.finalTableThreshold??9,!0),e(r).length=0,e(r).push(...n.structure??[]),e(s).length=0,e(s).push(...n.players??[]),e(d).length=0,e(d).push(...n.tables??[]),e(m).length=0,e(m).push(...n.eliminations??[]),e(i).currentLevelIndex=n.clock?.currentLevelIndex??0,e(i).timeRemaining=n.clock?.timeRemaining??0,e(i).isRunning=!1},reset(){l(c,""),l(g,"setup"),l(u,9),l(f,9),e(r).length=0,e(s).length=0,e(d).length=0,e(m).length=0,e(i).currentLevelIndex=0,e(i).timeRemaining=0,e(i).isRunning=!1,localStorage.removeItem("poker-tournament")},get standings(){const t=e(s).filter(a=>a.status==="active").map(a=>({...a,position:null})),n=[...e(m)].reverse().map((a,p)=>({...e(s).find(S=>S.id===a.playerId),position:t.length+p+1}));return t.forEach((a,p)=>{a.position=p+1}),t.length===1&&(t[0].position=1),[...t,...n]}}}const L=b();export{L as t};
